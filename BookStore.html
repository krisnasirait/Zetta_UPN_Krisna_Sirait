<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Book Purchasing Form</title>
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="purchase-book.js"></script>
</head>

<body>
    <h1>Book Purchasing Form</h1>
    <form onsubmit="return purchase()">
        <form onsubmit="return purchase()">
            <label for="title" class="form-label">Book Title:</label>
            <input type="text" id="title" name="title" required><br><br>
          
            <label for="author" class="form-label">Author:</label>
            <input type="text" id="author" name="author" required><br><br>
          
            <label for="year" class="form-label">Year:</label>
            <input type="number" id="year" name="year" required min="0"><br><br>
          
            <label for="price" class="form-label">Price:</label>
            <input type="number" id="price" name="price" required min="0"><br><br>
          
            <label for="discount" class="form-label">Discount (%):</label>
            <input type="number" id="discount" name="discount" required min="0"><br><br>
          
            <label for="tax" class="form-label">Tax (%):</label>
            <input type="number" id="tax" name="tax" value="5" readonly disabled><br><br>
          
            <label for="stock" class="form-label">Stock:</label>
            <input type="number" id="stock" name="stock" required min="0"><br><br>
          
            <label for="purchased" class="form-label">Amount Purchased:</label>
            <input type="number" id="purchased" name="purchased" required min="0"><br><br>
          
            <button type="submit" class="form-button">Purchase</button>
          
            <div id="output"></div>
          </form>
    </form>

    <div id="output"></div>

    <script type="text/javascript">
        function purchase() {
            let form = document.forms[0];
            let title = form.title.value;
            let author = form.author.value;
            let year = form.year.value;
            let price = form.price.value;
            let discount = form.discount.value;
            let stock = form.stock.value;
            let purchased = form.purchased.value;
          
            if (title == "" || author == "" || year == "" || price == "" || discount == "" || stock == "" || purchased == "") {
              alert("Please fill in all fields.");
              return false;
            }
          
            let yearInt = parseInt(year);
            let priceFloat = parseFloat(price);
            let discountFloat = parseFloat(discount);
            let tax = parseFloat(document.getElementById("tax").value);
            let stockInt = parseInt(stock);
            let purchasedInt = parseInt(purchased);
          
            let bookDetails = {
              title: title,
              author: author,
              year: yearInt,
              price: priceFloat
            };
          
            let totalPrice = 0;
            for (let i = 1; i <= purchasedInt; i++) {
              if (i > stockInt) {
                alert("Sorry, the book is out of stock.");
                break;
              }
          
              totalPrice += purchaseBook(bookDetails, discountFloat, tax, stockInt, i);
              stockInt--;
            }
          
            let output = document.getElementById("output");
            output.innerHTML = `<p>Total price: ${totalPrice.toLocaleString("id-ID", { style: "currency", currency: "IDR" })}</p>`;
          
            if (stockInt > 0) {
              output.innerHTML += `<p>${stockInt} book(s) left in stock.</p>`;
            } else {
              output.innerHTML += `<p>The book is out of stock.</p>`;
            }
          
            return false;
          }
    </script>
</body>

</html>